<style>
  body {
    padding: 0;
    margin: 0;
  }
  #container {
    display: flex;
    box-sizing: border-box;
    height: 100%;
    width: 100%;
    padding: 0;
    padding-left: 5px;
    padding-top: 5px;
    margin: 0;
  }
</style>
<body>
  <div id="container">
    <div id="root"></div>
    <div id="plot"></div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/brynja/cdn/brynja.js"></script>
  <script>
    const canvas = document.createElement('canvas');
    canvas.height = canvas.width = 600;
    canvas.style.height = canvas.style.width = canvas.height + 'px';
    const ctx = canvas.getContext('2d');

    const waves = [
      { amplitude: 7, frequency: 10 },
      { amplitude: 10, frequency: 15 },
      { amplitude: 20, frequency: 7 },
    ];

    const center = canvas.height * 0.5;
    const radius = canvas.height * 0.25;

    const calculatePoints = () => {
      const points = [];
      for (let i = 0; i < Math.PI*2; i += 0.001) {
        const x = Math.cos(i);
        const y = Math.sin(i);
        const f = ({amplitude, frequency}) => amplitude * Math.sin(frequency * i);
        const r = radius + waves.map(f).reduce((sum, v) => sum + v, 0);
        points.push([center + x * r, center + y * r]);
      }
      return points;
    }

    let points = calculatePoints();

    const drawFrame = (frameNumber) => () => {
      ctx.fillStyle = "rgb(255,255,255)";
      ctx.fillRect(0, 0, canvas.height, canvas.height);
      ctx.fillStyle = "rgb(0,0,0)";

      for (let i = 0; i < points.length; i++) {
        const [x, y] = points[i];
        const disturbance = 0.5 * Math.sin((frameNumber + i) * Math.PI / 180);
        ctx.fillRect(x + disturbance, y + disturbance, 1, 1);
      }
      requestAnimationFrame(drawFrame(frameNumber+1));
    }

    requestAnimationFrame(drawFrame(0));

    document.getElementById('plot').appendChild(canvas);

    const renderGUI = () => brynja.render(_=>_
      .child('button', _=>_
        .text('Add wave')
        .on('click', () => {
          waves.push({ amplitude: 1, frequency: 1 });
          points = calculatePoints();
          renderGUI();
        })
      )
      .child('ul', _=>_
        .children('li', waves.length, (_,i)=>_
          .child('label', _=>_
            .text('Amplitude: ')
            .child('input', _=>_
              .prop('type', 'number')
              .value(waves[i].amplitude)
              .on('change', (e) => {
                waves[i].amplitude = e.target.value;
                points = calculatePoints();
              })
            )
          )
          .child('label', _=>_
            .text(' Frequency: ')
            .child('input', _=>_
              .prop('type', 'number')
              .value(waves[i].frequency)
              .on('change', (e) => {
                waves[i].frequency = e.target.value;
                points = calculatePoints();
              })
            )
          )
        )
      )
    );

    renderGUI();
  </script>
</body>
